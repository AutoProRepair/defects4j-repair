237,243c237
<         int idx = 1;
<         while (count < index) {
<             count += idx;
<             ++idx;
<         }
<         --idx;
<         indices[last] = idx;
---
>         indices[last] = index - count;
