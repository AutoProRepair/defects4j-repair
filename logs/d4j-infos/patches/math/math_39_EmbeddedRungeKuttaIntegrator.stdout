249a250,258
>         if (forward) {
>             if (stepStart + stepSize >= t) {
>                 stepSize = t - stepStart;
>             }
>         } else {
>             if (stepStart + stepSize <= t) {
>                 stepSize = t - stepStart;
>             }
>         }
