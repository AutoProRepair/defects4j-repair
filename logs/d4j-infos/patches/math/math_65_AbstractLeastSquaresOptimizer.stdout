240,245c240
<         double criterion = 0;
<         for (int i = 0; i < rows; ++i) {
<             final double residual = residuals[i];
<             criterion += residualsWeights[i] * residual * residual;
<         }
<         return Math.sqrt(criterion / rows);
---
>         return Math.sqrt(getChiSquare() / rows);
249c244,246
<      * Get the Chi-Square value.
---
>      * Get a Chi-Square-like value assuming the N residuals follow N
>      * distinct normal distributions centered on 0 and whose variances are
>      * the reciprocal of the weights.
256c253
<             chiSquare += residual * residual / residualsWeights[i];
---
>             chiSquare += residual * residual * residualsWeights[i];
