1198a1199,1206
>       Scope scope = getQnameRootScope(n);
>       return scope != null && scope.isGlobal();
>     }
> 
>     /**
>      * Return the scope for the name of the given node.
>      */
>     private Scope getQnameRootScope(Node n) {
1203c1211
<           return var.isGlobal();
---
>           return var.getScope();
1206c1214
<       return false;
---
>       return null;
1513c1521
<       if (inferred) {
---
>       if (inferred && rhsValue != null && rhsValue.isFunction()) {
1515,1517c1523,1528
<         inferred = !(rhsValue != null &&
<             rhsValue.isFunction() &&
<             (info != null || !scope.isDeclared(qName, false)));
---
>         if (info != null) {
>           inferred = false;
>         } else if (!scope.isDeclared(qName, false) &&
>                    n.isUnscopedQualifiedName()) {
>           inferred = false;
>         }
1538,1539c1549
<       } else if (rhsValue != null &&
<           rhsValue.isTrue()) {
---
>       } else if (rhsValue != null && rhsValue.isTrue()) {
