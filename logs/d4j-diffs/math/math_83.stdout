org.apache.commons.math.optimization.linear.SimplexTableau

292c292,293
<         for (int i = getNumObjectiveFunctions(); i < getHeight(); i++) {
---
>         int start = ignoreObjectiveRows ? getNumObjectiveFunctions() : 0;
>         for (int i = start; i < getHeight(); i++) {
340,341c341,342
<       Integer basicRow = getBasicRow(getNumObjectiveFunctions() + getOriginalNumDecisionVariables());
<       double mostNegative = basicRow == null ? 0 : getEntry(basicRow, getRhsOffset());
---
>       Integer negativeVarBasicRow = getBasicRowForSolution(getNegativeDecisionVariableOffset());
>       double mostNegative = negativeVarBasicRow == null ? 0 : getEntry(negativeVarBasicRow, getRhsOffset());
344c345
<            basicRow = getBasicRow(getNumObjectiveFunctions() + i);
---
>           Integer basicRow = getBasicRowForSolution(getNumObjectiveFunctions() + i);


