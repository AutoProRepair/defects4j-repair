#!/bin/bash

export PATH="~/defects4j-nopol/defects4j/framework/bin:$PATH"

echo "Starting Lang deployment ..."

for bug in `seq 1 50`;
do
  stdout_file = "~/results/d4j-tests/lang/buggy/lang_$(echo $bug)_buggy.stdout"
  stderr_file = "~/results/d4j-tests/lang/buggy/lang_$(echo $bug)_buggy.stderr"
  project_directory = "/tmp/lang_$(bug)_buggy/"
  oarsub -O $stdout_file -E $stderr_file "cd /tmp/ && defects4j checkout -p Lang -v $(echo $bug)b -w $project_directory && cd $project_directory && defects4j compile && defects4j test"
done

echo "Waiting 300 sec ..."
sleep 300

for bug in `seq 51 65`;
do
        oarsub -O ~/results/d4j-tests/Lang/Lang_$bug'_buggy'.stdout -E ~/results/d4j-tests/Lang/Lang_$bug'_buggy'.stderr "cd ~/ressources/Lang/Lang_$bug'_buggy' && ~/defects4j/framework/bin/defects4j test"
done
